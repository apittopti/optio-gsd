<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <!-- Gradients -->
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#6366f1"/>
      <stop offset="100%" style="stop-color:#8b5cf6"/>
    </linearGradient>
    <linearGradient id="coreGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#2563eb"/>
    </linearGradient>
    <linearGradient id="optionalGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#7c3aed"/>
    </linearGradient>
    <linearGradient id="recoveryGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="anytimeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>

    <!-- Arrow marker -->
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#3b82f6"/>
    </marker>
    <marker id="arrowGray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#6b7280"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#f59e0b"/>
    </marker>

    <!-- Shadow filter -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="#f8fafc"/>

  <!-- Header -->
  <rect x="0" y="0" width="1200" height="70" fill="url(#headerGrad)"/>
  <text x="600" y="42" text-anchor="middle" fill="white" font-size="28" font-weight="bold">opti-gsd Workflow</text>
  <text x="600" y="60" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-size="12">Spec-driven development with fresh context</text>

  <!-- Legend -->
  <g transform="translate(900, 90)">
    <rect x="0" y="0" width="280" height="130" rx="8" fill="white" stroke="#e2e8f0" filter="url(#shadow)"/>
    <text x="15" y="25" font-size="14" font-weight="600" fill="#1e293b">Legend</text>

    <rect x="15" y="40" width="20" height="14" rx="3" fill="url(#coreGrad)"/>
    <text x="45" y="51" font-size="11" fill="#475569">Core Workflow (5 commands)</text>

    <rect x="15" y="60" width="20" height="14" rx="3" fill="url(#optionalGrad)"/>
    <text x="45" y="71" font-size="11" fill="#475569">Optional Step</text>

    <rect x="15" y="80" width="20" height="14" rx="3" fill="url(#recoveryGrad)"/>
    <text x="45" y="91" font-size="11" fill="#475569">Recovery (when things break)</text>

    <rect x="15" y="100" width="20" height="14" rx="3" fill="url(#anytimeGrad)"/>
    <text x="45" y="111" font-size="11" fill="#475569">Anytime Commands</text>
  </g>

  <!-- Main Workflow Box -->
  <rect x="40" y="90" width="840" height="380" rx="12" fill="white" stroke="#e2e8f0" stroke-width="2" filter="url(#shadow)"/>
  <text x="60" y="120" font-size="16" font-weight="600" fill="#1e293b">The Main Loop (repeat per phase)</text>

  <!-- ROADMAP -->
  <rect x="80" y="150" width="120" height="50" rx="8" fill="url(#coreGrad)" filter="url(#shadow)"/>
  <text x="140" y="180" text-anchor="middle" fill="white" font-size="14" font-weight="600">ROADMAP</text>

  <!-- Arrow to PLAN -->
  <line x1="200" y1="175" x2="240" y2="175" stroke="#3b82f6" stroke-width="3" marker-end="url(#arrowBlue)"/>

  <!-- PLAN -->
  <rect x="250" y="150" width="120" height="50" rx="8" fill="url(#coreGrad)" filter="url(#shadow)"/>
  <text x="310" y="180" text-anchor="middle" fill="white" font-size="14" font-weight="600">PLAN</text>

  <!-- Arrow to EXECUTE -->
  <line x1="370" y1="175" x2="410" y2="175" stroke="#3b82f6" stroke-width="3" marker-end="url(#arrowBlue)"/>

  <!-- EXECUTE -->
  <rect x="420" y="150" width="120" height="50" rx="8" fill="url(#coreGrad)" filter="url(#shadow)"/>
  <text x="480" y="180" text-anchor="middle" fill="white" font-size="14" font-weight="600">EXECUTE</text>

  <!-- Fork after EXECUTE -->
  <line x1="540" y1="175" x2="580" y2="175" stroke="#3b82f6" stroke-width="3"/>
  <circle cx="580" cy="175" r="6" fill="#3b82f6"/>

  <!-- Path to PUSH -->
  <line x1="586" y1="175" x2="610" y2="175" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="610" y1="175" x2="610" y2="145" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="610" y1="145" x2="650" y2="145" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowGray)"/>

  <!-- PUSH (optional) -->
  <rect x="660" y="120" width="100" height="50" rx="8" fill="url(#optionalGrad)" filter="url(#shadow)"/>
  <text x="710" y="145" text-anchor="middle" fill="white" font-size="13" font-weight="600">PUSH</text>
  <text x="710" y="160" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-size="10">(optional)</text>

  <!-- Arrow from PUSH to VERIFY -->
  <line x1="760" y1="145" x2="790" y2="145" stroke="#3b82f6" stroke-width="2"/>
  <line x1="790" y1="145" x2="790" y2="205" stroke="#3b82f6" stroke-width="2"/>
  <line x1="790" y1="205" x2="760" y2="205" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowBlue)"/>

  <!-- Direct path to VERIFY (skip PUSH) -->
  <line x1="586" y1="175" x2="610" y2="175" stroke="#3b82f6" stroke-width="2"/>
  <line x1="610" y1="175" x2="610" y2="205" stroke="#3b82f6" stroke-width="2"/>
  <line x1="610" y1="205" x2="650" y2="205" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <text x="630" y="195" text-anchor="middle" fill="#6b7280" font-size="9">or direct</text>

  <!-- VERIFY -->
  <rect x="660" y="180" width="100" height="50" rx="8" fill="url(#coreGrad)" filter="url(#shadow)"/>
  <text x="710" y="210" text-anchor="middle" fill="white" font-size="14" font-weight="600">VERIFY</text>

  <!-- Fork after VERIFY -->
  <line x1="710" y1="230" x2="710" y2="270" stroke="#3b82f6" stroke-width="2"/>
  <circle cx="710" cy="270" r="6" fill="#3b82f6"/>

  <!-- PASS path - Next Phase -->
  <line x1="704" y1="270" x2="620" y2="270" stroke="#10b981" stroke-width="2"/>
  <text x="660" y="265" text-anchor="middle" fill="#10b981" font-size="10" font-weight="600">PASS</text>
  <line x1="620" y1="270" x2="620" y2="320" stroke="#10b981" stroke-width="2"/>

  <!-- Next Phase box -->
  <rect x="560" y="300" width="120" height="40" rx="6" fill="#dcfce7" stroke="#10b981" stroke-width="2"/>
  <text x="620" y="325" text-anchor="middle" fill="#166534" font-size="12" font-weight="600">Next Phase</text>

  <!-- Loop back arrow -->
  <path d="M560,320 Q500,320 500,280 Q500,240 310,240 Q260,240 260,200" fill="none" stroke="#10b981" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <text x="380" y="255" text-anchor="middle" fill="#10b981" font-size="10">repeat</text>

  <!-- GAPS path - back to Execute -->
  <line x1="716" y1="270" x2="800" y2="270" stroke="#f59e0b" stroke-width="2"/>
  <text x="755" y="265" text-anchor="middle" fill="#f59e0b" font-size="10" font-weight="600">GAPS</text>
  <line x1="800" y1="270" x2="800" y2="370" stroke="#f59e0b" stroke-width="2"/>
  <line x1="800" y1="370" x2="480" y2="370" stroke="#f59e0b" stroke-width="2"/>
  <line x1="480" y1="370" x2="480" y2="200" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowOrange)"/>
  <text x="640" y="385" text-anchor="middle" fill="#f59e0b" font-size="10">fix &amp; retry</text>

  <!-- Command labels -->
  <text x="140" y="215" text-anchor="middle" fill="#64748b" font-size="10">/roadmap</text>
  <text x="310" y="215" text-anchor="middle" fill="#64748b" font-size="10">/plan-phase</text>
  <text x="480" y="215" text-anchor="middle" fill="#64748b" font-size="10">/execute</text>
  <text x="710" y="240" text-anchor="middle" fill="#64748b" font-size="10">/verify</text>
  <text x="710" y="180" text-anchor="middle" fill="#a78bfa" font-size="10">/push</text>

  <!-- TDD indicator -->
  <rect x="425" y="240" width="110" height="30" rx="4" fill="#dbeafe" stroke="#3b82f6"/>
  <text x="480" y="260" text-anchor="middle" fill="#1e40af" font-size="10">TDD: RED-GREEN-REFACTOR</text>

  <!-- Recovery Commands Box -->
  <rect x="40" y="490" width="360" height="180" rx="12" fill="white" stroke="#fbbf24" stroke-width="2" filter="url(#shadow)"/>
  <rect x="40" y="490" width="360" height="35" rx="12" fill="url(#recoveryGrad)"/>
  <rect x="40" y="510" width="360" height="15" fill="url(#recoveryGrad)"/>
  <text x="220" y="515" text-anchor="middle" fill="white" font-size="14" font-weight="600">Recovery Commands</text>
  <text x="60" y="555" fill="#92400e" font-size="12" font-weight="600">/recover</text>
  <text x="180" y="555" fill="#78716c" font-size="11">Diagnose &amp; fix interrupted execution</text>
  <text x="60" y="585" fill="#92400e" font-size="12" font-weight="600">/rollback</text>
  <text x="180" y="585" fill="#78716c" font-size="11">Undo to a previous checkpoint</text>
  <text x="60" y="615" fill="#92400e" font-size="12" font-weight="600">/plan-fix</text>
  <text x="180" y="615" fill="#78716c" font-size="11">Generate fix plan for verification gaps</text>
  <text x="60" y="650" fill="#94a3b8" font-size="10" font-style="italic">Use when things go wrong</text>

  <!-- Anytime Commands Box -->
  <rect x="420" y="490" width="360" height="180" rx="12" fill="white" stroke="#10b981" stroke-width="2" filter="url(#shadow)"/>
  <rect x="420" y="490" width="360" height="35" rx="12" fill="url(#anytimeGrad)"/>
  <rect x="420" y="510" width="360" height="15" fill="url(#anytimeGrad)"/>
  <text x="600" y="515" text-anchor="middle" fill="white" font-size="14" font-weight="600">Anytime Commands</text>
  <text x="440" y="555" fill="#065f46" font-size="12" font-weight="600">/status</text>
  <text x="540" y="555" fill="#78716c" font-size="11">Where am I? What's next?</text>
  <text x="440" y="580" fill="#065f46" font-size="12" font-weight="600">/add-feature</text>
  <text x="540" y="580" fill="#78716c" font-size="11">Capture idea for later</text>
  <text x="440" y="605" fill="#065f46" font-size="12" font-weight="600">/add-story</text>
  <text x="540" y="605" fill="#78716c" font-size="11">Capture user request</text>
  <text x="440" y="630" fill="#065f46" font-size="12" font-weight="600">/debug</text>
  <text x="540" y="630" fill="#78716c" font-size="11">Systematic bug investigation</text>
  <text x="440" y="655" fill="#065f46" font-size="12" font-weight="600">/help</text>
  <text x="540" y="655" fill="#78716c" font-size="11">Show all commands</text>

  <!-- Milestone Commands Box -->
  <rect x="800" y="490" width="360" height="180" rx="12" fill="white" stroke="#6366f1" stroke-width="2" filter="url(#shadow)"/>
  <rect x="800" y="490" width="360" height="35" rx="12" fill="url(#headerGrad)"/>
  <rect x="800" y="510" width="360" height="15" fill="url(#headerGrad)"/>
  <text x="980" y="515" text-anchor="middle" fill="white" font-size="14" font-weight="600">Milestones &amp; Setup</text>
  <text x="820" y="555" fill="#4338ca" font-size="12" font-weight="600">/start-milestone</text>
  <text x="960" y="555" fill="#78716c" font-size="11">Create milestone branch</text>
  <text x="820" y="580" fill="#4338ca" font-size="12" font-weight="600">/complete-milestone</text>
  <text x="980" y="580" fill="#78716c" font-size="11">Create PR, finalize</text>
  <text x="820" y="615" fill="#4338ca" font-size="12" font-weight="600">/init</text>
  <text x="880" y="615" fill="#78716c" font-size="11">Initialize in existing project</text>
  <text x="820" y="640" fill="#4338ca" font-size="12" font-weight="600">/new-project</text>
  <text x="940" y="640" fill="#78716c" font-size="11">Create new project</text>

  <!-- Quick Start Box -->
  <rect x="40" y="690" width="560" height="190" rx="12" fill="#f0fdf4" stroke="#10b981" stroke-width="2" filter="url(#shadow)"/>
  <text x="60" y="720" fill="#166534" font-size="16" font-weight="700">Quick Start</text>

  <text x="60" y="750" fill="#1e293b" font-size="13" font-weight="600">New Project:</text>
  <text x="60" y="775" fill="#475569" font-size="12" font-family="monospace">/new-project → /roadmap → /plan-phase 1 → /execute → /verify 1</text>

  <text x="60" y="810" fill="#1e293b" font-size="13" font-weight="600">Existing Project:</text>
  <text x="60" y="835" fill="#475569" font-size="12" font-family="monospace">/init → /roadmap → /plan-phase 1 → /execute → /verify 1</text>

  <text x="60" y="865" fill="#64748b" font-size="11" font-style="italic">Lost? Run /status to see where you are and what to do next.</text>

  <!-- Command Count -->
  <rect x="620" y="690" width="250" height="190" rx="12" fill="white" stroke="#e2e8f0" stroke-width="2" filter="url(#shadow)"/>
  <text x="745" y="720" text-anchor="middle" fill="#1e293b" font-size="14" font-weight="700">40 Commands Total</text>

  <text x="640" y="750" fill="#3b82f6" font-size="12">Core Workflow</text>
  <text x="830" y="750" text-anchor="end" fill="#64748b" font-size="12">5</text>

  <text x="640" y="775" fill="#8b5cf6" font-size="12">Setup &amp; Planning</text>
  <text x="830" y="775" text-anchor="end" fill="#64748b" font-size="12">10</text>

  <text x="640" y="800" fill="#f59e0b" font-size="12">Recovery</text>
  <text x="830" y="800" text-anchor="end" fill="#64748b" font-size="12">3</text>

  <text x="640" y="825" fill="#10b981" font-size="12">Anytime &amp; Tracking</text>
  <text x="830" y="825" text-anchor="end" fill="#64748b" font-size="12">15</text>

  <text x="640" y="850" fill="#6366f1" font-size="12">Config &amp; Context</text>
  <text x="830" y="850" text-anchor="end" fill="#64748b" font-size="12">7</text>

  <!-- Key insight box -->
  <rect x="890" y="690" width="270" height="190" rx="12" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
  <text x="1025" y="720" text-anchor="middle" fill="#92400e" font-size="14" font-weight="700">Key Insight</text>
  <text x="910" y="755" fill="#78350f" font-size="12">The workflow is</text>
  <text x="910" y="775" fill="#78350f" font-size="14" font-weight="700">NOT strictly sequential:</text>
  <text x="920" y="805" fill="#78350f" font-size="11">• PUSH is optional</text>
  <text x="920" y="825" fill="#78350f" font-size="11">• Can verify locally</text>
  <text x="920" y="845" fill="#78350f" font-size="11">• Gaps loop back to EXECUTE</text>
  <text x="920" y="865" fill="#78350f" font-size="11">• Human judgment gates flow</text>
</svg>